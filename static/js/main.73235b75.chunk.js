(this.webpackJsonpspotifgen=this.webpackJsonpspotifgen||[]).push([[0],{90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(7),i=n(10),c=n(2),o=n(138),u=n.p+"static/media/lpimage.7c8aaed5.svg",l=n(98),s=n(133),m=n(134),d=n(6),f=n(19);var v=n(61),g="sessionId";function h(e){var t=localStorage.getItem(g);if(null!==t)return t;var n=v();return localStorage.setItem(g,n),n}var p="https://accounts.spotify.com/authorize?"+String(new URLSearchParams({client_id:"2e53e2a82ee64c4dbf48f4936ae1bb02",response_type:"token",redirect_uri:"https://spotigen.bitvictory.dev",scope:"playlist-modify-private",state:h()}));function E(e){var t=f.a(d.g(d.e(d.g(window.location.hash.slice(1).split("&"),(function(e){return e.split("=")})),(function(e){return 2===e.length})),(function(e){return[e[0],String(e[1])]}))),n=f.b(t,"state");if(void 0!==n&&n===h()){!function(e){var t=window.location.origin;console.log(t),window.history.replaceState(window.history.state,"",t)}();var r=f.b(t,"access_token");return void 0!==r?r:void 0}}var y=u;var _=function(e){return r.createElement("div",{className:"landing"},r.createElement("div",{className:"spacing"},r.createElement("img",{style:{maxWidth:"70%"},alt:"logo",src:y}),r.createElement(l.a,{children:"Welcome to spotigen",className:"spacing",variant:"h4"}),r.createElement("br",void 0),r.createElement(l.a,{children:"Create playlists with recommendations based on your favourite tracks, artists and genres.",className:"spacing",style:{marginBottom:"64px"}}),r.createElement(l.a,{children:null,className:"spacing",style:{marginBottom:"16px"}},"By connecting your Spotify account, you agree to our ",r.createElement(s.a,{children:"privacy policy",href:"https://bitvictory.de/spotigen/privacy.md",target:"_blank"})),r.createElement(m.a,{onClick:function(e){window.location.replace(p)},children:"Login with Spotify",color:"primary",variant:"contained"})))},b=n(144);n(90);var S=function(e){var t=e.name,n=e.image,i=e.item;return r.createElement("div",{className:"person"},void 0!==n?r.createElement(b.a,{alt:t,src:n}):r.createElement(b.a,{children:t[0]}),r.createElement("div",{className:"person-name"},void 0!==i?a.b(i):r.createElement(l.a,{children:t})))};var T=function(e){return r.createElement("div",{className:"footer"},r.createElement(l.a,{children:"Created with \u2764\ufe0f in Mannheim".normalize()}),r.createElement(l.a,{children:null},r.createElement(s.a,{children:"Github",href:"https://github.com/teambitvictory/spotigen",target:"_blank"})," | ",r.createElement(s.a,{children:"Privacy Policy",href:"https://bitvictory.de/spotigen/privacy.md",target:"_blank"})," | ",r.createElement(s.a,{children:"Imprint",href:"https://bitvictory.de/spotigen/imprint.md",target:"_blank"})),r.createElement("div",{style:{margin:"auto",width:"180px"}},r.createElement(S,{name:"Damien Jochim",image:"https://pbs.twimg.com/profile_images/1284521496438874112/LDA9UyiN_400x400.jpg",item:r.createElement(s.a,{children:"@damien_jochim",href:"https://twitter.com/damien_jochim",target:"_blank"})}),r.createElement(S,{name:"Stefan Blamberg",image:"https://pbs.twimg.com/profile_images/1328445229221949442/1uPmXD13_400x400.jpg",item:r.createElement(s.a,{children:"@StefanBlamberg",href:"https://twitter.com/StefanBlamberg",target:"_blank"})})))},k=i.b({key:"userState",default:{id:"guest",name:"Guest",image:""}}),G=i.b({key:"tokenState",default:""});var A=function(e){var t=i.c(G)[1],n=i.d(k);return r.createElement("div",{className:"hbox"},r.createElement(S,{name:n.name,image:n.image,item:r.createElement(l.a,{children:null},n.name+" | ",r.createElement(s.a,{children:"Logout",onClick:function(e){return e.preventDefault(),c.a(t,(function(e){return""}))},href:"#"}))}))};n(91);var w=function(e){var t=e.authenticated;return r.createElement("div",{className:"header"},r.createElement(l.a,{children:"spotigen"}),t?r.createElement(A,{}):null)},C=n(66),N=n(13),P=n(141),L=n(44),B=n(143),x=n(67),R=n(140),F=n(137),j=n(139),q=n(36);function I(e){return[e,e._0.id]}var U=n(135),D=n(69),z=n.n(D),O=n(68),$=n.n(O);n(92);var W=function(e){var t,n=e.item,a=e.showGenreLabel,i=e.control;switch(0|n.TAG){case 0:t=[n._0.name,"",a?"Genre":""];break;case 1:var c=n._0;t=[c.name,c.image,"Artist"];break;case 2:var o=n._0;t=[o.name,o.image,"Track by "+d.d(o.artists,", ",(function(e){return e.name}))]}var u=t[2],s=t[1],m=t[0],f=""===s?r.createElement(b.a,{children:m[0],className:"cover",variant:"square"}):r.createElement("img",{className:"cover",src:s}),v=""===u?null:r.createElement(l.a,{children:u,className:"description"});return r.createElement("div",{className:"item"},f,r.createElement("div",{className:"caption"},r.createElement(l.a,{children:m}),v),i)},J=i.b({key:"selectionState",default:[]});var M=function(e){var t=e.item,n=e.added,a=i.c(J)[1],o=n?r.createElement(U.a,{onClick:function(e){var n=I(t)[1];return c.a(a,(function(e){return d.e(e,(function(e){return I(e)[1]!==n}))}))},children:r.createElement($.a,{})}):r.createElement(U.a,{onClick:function(e){return c.a(a,(function(e){return d.a(e,[t])}))},children:r.createElement(z.a,{})});return r.createElement(W,{item:t,showGenreLabel:!1,control:o})};var Y=function(e){var t=e.spotifyClient,n=r.useState((function(){return[]})),a=n[1],o=r.useState((function(){return""})),u=o[1],s=o[0],m=i.c(J)[0];return r.useEffect((function(){N.a(c.a(t.getGenres,void 0),(function(e){if(0===e.TAG){var t=e._0;return c.a(a,(function(e){return t}))}console.log(e._0)}))}),[]),r.createElement("div",void 0,r.createElement("form",{autoComplete:"off"},r.createElement(j.a,{className:"input",onChange:function(e){return c.a(u,e.target.value)},placeholder:"Search",value:q.a.string(s),variant:"outlined"})),r.createElement("div",{className:"spacing"},0!==s.length?d.g(d.e(d.g(n[0],I),(function(e){return""!==s&&e[1].includes(s)})),(function(e){var t=e[1],n=d.m(m,(function(e){return I(e)[1]===t}));return r.createElement(M,{item:e[0],added:n,key:t})})):r.createElement(l.a,{children:"Enter a search term to select genres",style:{color:"grey"}})))};var H=function(e){var t=e.spotifyClient,n=r.useState((function(){return""})),a=n[1],o=n[0],u=function(e,t){var n=r.useState((function(){return e})),a=n[1];return r.useEffect((function(){var n=setTimeout((function(t){return c.a(a,(function(t){return e}))}),t);return function(e){clearTimeout(n)}}),[e]),n[0]}(o,400),s=r.useState((function(){return[]})),m=s[1],f=s[0],v=i.c(J)[0];return r.useEffect((function(){""===u?c.a(m,(function(e){return[]})):N.a(c.a(t.getSearch,u),(function(e){if(0===e.TAG){var t=e._0;return c.a(m,(function(e){return t}))}console.log(e._0)}))}),[u]),r.createElement("div",void 0,r.createElement("form",{autoComplete:"off"},r.createElement(j.a,{className:"input",onChange:function(e){return c.a(a,e.target.value)},placeholder:"Search",value:q.a.string(o),variant:"outlined"})),r.createElement("div",{className:"spacing"},0!==f.length?d.g(f,(function(e){var t=I(e)[1],n=d.m(v,(function(e){return I(e)[1]===t}));return r.createElement(M,{item:e,added:n,key:t})})):r.createElement(l.a,{children:"Enter a search term to select items",style:{color:"grey"}})))},X=n(70),K=n.n(X);var Q=function(e){var t=e.item,n=e.id,a=e.onRemove;return r.createElement(W,{item:t,showGenreLabel:!0,control:r.createElement(U.a,{onClick:function(e){return c.a(a,n)},children:r.createElement(K.a,{})})})};var V=function(e){var t=i.c(J),n=t[1],a=t[0],o=function(e){return c.a(n,(function(t){return d.e(t,(function(t){return I(t)[1]!==e}))}))};return r.createElement("div",{className:"spacing"},0!==a.length?d.g(a,(function(e){var t=I(e)[1];return r.createElement(Q,{item:e,id:t,onRemove:o,key:t})})):r.createElement(l.a,{children:"Select at least one item to generate recommendations",style:{color:"grey"}}))},Z=i.b({key:"recommendationsState",default:[]});var ee=function(e){var t=e.spotifyClient,n=e.onSeedTooSmall,a=r.useState((function(){return 0})),o=a[1],u=a[0],s=i.d(J),d=i.c(Z)[1];return r.createElement("div",void 0,r.createElement(l.a,{children:"Get started",className:"spacing",variant:"h4"}),r.createElement(l.a,{children:"Choose tracks, genres and artists as a base for your recommendations"}),r.createElement(R.a,{centered:!0,children:null,className:"spacing",indicatorColor:"primary",onChange:function(e,t){return c.a(o,(function(e){return x.a(t)}))},textColor:"primary",value:u,variant:"fullWidth"},r.createElement(F.a,{label:"Search"}),r.createElement(F.a,{label:"Genres"})),0!==u?1!==u?null:r.createElement(Y,{spotifyClient:t}):r.createElement(H,{spotifyClient:t}),r.createElement(l.a,{children:"Your selection",variant:"h4"}),r.createElement(V,{}),r.createElement(m.a,{onClick:function(e){return N.a(c.a(t.getRecommendation,s),(function(e){if(0===e.TAG){var t=e._0;return 0!==t.length?c.a(d,(function(e){return t})):c.a(n,void 0)}console.log(e._0)}))},children:"Generate recommendations",color:"primary",disabled:0===s.length,variant:"contained"}))},te=n(21),ne=n(23);function re(e){return"Timeout"===e?2:1}function ae(e){var t=d.c(e.images,0);return{id:e.id,name:e.display_name,image:void 0!==t?t.url:""}}function ie(e){if(200!==e.status)return{TAG:1,_0:{_0:{message:"Failed request with $status"}}};var t=e.response;return void 0!==t?{TAG:0,_0:ae(t)}:{TAG:1,_0:0}}function ce(e){var t=te.b([["Authorization","Bearer "+e]]);return function(e){return N.f(N.d(ne.a("https://api.spotify.com/v1/me",void 0,5,void 0,a.a(t),void 0,void 0,void 0,void 0,void 0),!0,re),!0,ie)}}function oe(e){return{TAG:0,_0:{id:e,name:e.replace(/\-/g," ").toUpperCase()}}}function ue(e){if(200!==e.status)return{TAG:1,_0:{_0:{message:"Failed request with $status"}}};var t=e.response;return void 0===t?{TAG:1,_0:0}:{TAG:0,_0:d.g(t.genres,oe)}}function le(e){var t=te.b([["Authorization","Bearer "+e]]);return function(e){return N.f(N.d(ne.a("https://api.spotify.com/v1/recommendations/available-genre-seeds",void 0,5,void 0,a.a(t),void 0,void 0,void 0,void 0,void 0),!0,re),!0,ue)}}function se(e){var t={url:"",height:999999};return void 0!==e?d.h(e,t,(function(e,t){return e.height<t.height?e:t})):t}function me(e){return{id:e.id,name:e.name,image:se(e.images).url}}function de(e){return{id:e.id,artists:d.g(e.artists,me),name:e.name,image:se(e.album.images).url,uri:e.uri}}function fe(e){if(200!==e.status)return{TAG:1,_0:{_0:{message:"Failed request with $status"}}};var t=e.response;if(void 0===t)return{TAG:1,_0:0};var n=d.g(d.g(t.artists.items,me),(function(e){return{TAG:1,_0:e}})),r=d.g(d.g(t.tracks.items,de),(function(e){return{TAG:2,_0:e}}));return{TAG:0,_0:d.a(n,r)}}function ve(e){var t=te.b([["Authorization","Bearer "+e]]);return function(e){var n=String(new URLSearchParams({q:e,type:"artist,track",limit:5}));return N.f(N.d(ne.a("https://api.spotify.com/v1/search?"+n,void 0,5,void 0,a.a(t),void 0,void 0,void 0,void 0,void 0),!0,re),!0,fe)}}function ge(e){if(201!==e.status)return console.log(e),{TAG:1,_0:{_0:{message:"Failed request to create Playlist"}}};var t=e.response;return void 0!==t?{TAG:0,_0:a.b(t)}:{TAG:1,_0:0}}function he(e){var t=f.a([]),n=function(e){return d.e(d.g(e,(function(e){switch(0|e.TAG){case 0:case 1:return;case 2:return e._0.uri}})),(function(e){return void 0!==e})).join(",")}(e);return 0!==n.length&&f.c(t,"uris",n),String(new URLSearchParams(f.d(t)))}function pe(e){if(200!==e.status)return{TAG:1,_0:{_0:{message:"Failed request to add tracks to playlist"}}};var t=e.response;return void 0!==t?{TAG:0,_0:a.b(t)}:{TAG:1,_0:0}}function Ee(e){var t=te.b([["Authorization","Bearer "+e]]);return function(e,n,r){return N.c(N.e(function(e,t,n){var r={};r.name=t,r.public=!1;var i=JSON.stringify(r);return console.log(i),N.f(N.d(ne.a("https://api.spotify.com/v1/users/"+e+"/playlists","POST",5,i,a.a(n),void 0,void 0,void 0,void 0,void 0),!0,re),!0,ge)}(e,n,t),!0,(function(e){return function(e,t,n){var r=he(t);return N.f(N.d(ne.a("https://api.spotify.com/v1/playlists/"+e+"/tracks?"+r,"POST",5,void 0,a.a(n),void 0,void 0,void 0,void 0,void 0),!0,re),!0,pe)}(e.id,r,t)})),!0,(function(e){return""}))}}function ye(e){if(200!==e.status)return{TAG:1,_0:{_0:{message:"Failed request with $status"}}};var t=e.response;return void 0===t?{TAG:1,_0:0}:{TAG:0,_0:d.g(d.g(t.tracks,de),(function(e){return{TAG:2,_0:e}}))}}function _e(e){var t=f.a([]);f.c(t,"limit","20");var n=function(e){return d.e(d.g(e,(function(e){switch(0|e.TAG){case 1:return e._0.id;case 0:case 2:return}})),(function(e){return void 0!==e})).join(",")}(e);0!==n.length&&f.c(t,"seed_artists",n);var r=function(e){return d.e(d.g(e,(function(e){switch(0|e.TAG){case 0:case 1:return;case 2:return e._0.id}})),(function(e){return void 0!==e})).join(",")}(e);0!==r.length&&f.c(t,"seed_tracks",r);var a=function(e){return d.e(d.g(e,(function(e){switch(0|e.TAG){case 0:return e._0.id;case 1:case 2:return}})),(function(e){return void 0!==e})).join(",")}(e);return 0!==a.length&&f.c(t,"seed_genres",a),String(new URLSearchParams(f.d(t)))}function be(e){var t=te.b([["Authorization","Bearer "+e]]);return function(e){var n=_e(function(e,t){var n=t>e.length?e.length:t,r=d.j(e);return[d.k(r,0,n),[function(e){return d.l(r,e)},n]]}(e,5)[0]);return N.f(N.d(ne.a("https://api.spotify.com/v1/recommendations?"+n,void 0,5,void 0,a.a(t),void 0,void 0,void 0,void 0,void 0),!0,re),!0,ye)}}var Se=function(e){var t=e.spotifyClient,n=e.onPlaylistCreated,a=r.useState((function(){return""})),o=a[1],u=a[0],s=i.c(Z),f=s[1],v=s[0],g=i.d(k);return r.createElement("div",void 0,r.createElement(m.a,{onClick:function(e){return c.a(f,(function(e){return[]}))},children:"<- Back to selection"}),r.createElement(l.a,{children:"Recommendations",variant:"h4"}),r.createElement("div",{className:"hbox",style:{margin:"16px auto"}},r.createElement(j.a,{style:{marginRight:"8px",flex:"1"},onChange:function(e){return c.a(o,e.target.value)},placeholder:"Playlist Name",value:q.a.string(u),variant:"outlined"}),r.createElement(m.a,{onClick:function(e){return N.a(c.b(t.createPlaylist,g.id,u,v),(function(e){return c.a(f,(function(e){return[]})),c.a(n,void 0)}))},children:"Save in Spotify",color:"primary",disabled:0===u.length,variant:"contained"})),d.g(v,(function(e){var t=I(e);return r.createElement(W,{item:e,showGenreLabel:!1,control:null,key:t[1]})})))};var Te=function(e){var t,n=i.d(G),a=i.d(Z),o=i.c(k)[1],u=r.useState((function(){return""})),l=u[1],s=u[0],m=function(e){return{getSearch:ve(e),getGenres:le(e),getRecommendation:be(e),createPlaylist:Ee(e),getUser:ce(e)}}(n);switch(r.useEffect((function(){N.a(c.a(m.getUser,void 0),(function(e){if(0===e.TAG){var t=e._0;return c.a(o,(function(e){return t}))}console.log(e._0)}))}),[]),s){case"NO_CONTENT":t=["Error","More seed items required"];break;case"PLAYLIST_CREATED":t=["Success","Playlist created"];break;default:t=["Error","Unknown error"]}return r.createElement("div",void 0,0!==a.length?r.createElement(Se,{spotifyClient:m,onPlaylistCreated:function(e){return c.a(l,(function(e){return"PLAYLIST_CREATED"}))}}):r.createElement(ee,{spotifyClient:m,onSeedTooSmall:function(e){return c.a(l,(function(e){return"NO_CONTENT"}))}}),r.createElement(B.a,{autoHideDuration:L.a.$$int(6e3),children:r.createElement(P.a,{children:t[1],onClose:function(e){return c.a(l,(function(e){return""}))},severity:function(){switch(t[0]){case"Error":return"error";case"Info":return"info";case"Success":return"success";case"Warning":return"warning"}}()}),onClose:function(e,t){return c.a(l,(function(e){return""}))},open:0!==s.length}))};var ke=function(e){var t=i.c(G),n=t[1],a=t[0];return r.useEffect((function(){var e=E();void 0!==e?c.a(n,(function(t){return e})):c.a(n,(function(e){return""}))}),[]),r.createElement("div",{className:"main-container"},r.createElement("div",{className:"content"},r.createElement(w,{authenticated:0!==a.length}),r.createElement(o.a,{children:0!==a.length?r.createElement(Te,{}):r.createElement(_,{}),maxWidth:C.a.sm})),r.createElement(T,{}))};n(95);var Ge=function(e){return r.createElement(i.a,{children:r.createElement(ke,{})})},Ae=n(15);n(96);var we=function(e){var t=document.getElementById(e);if(null!=t)return a.a(Ae.unstable_createRoot(t))}("root");void 0!==we&&a.b(we).render(r.createElement(r.StrictMode,{children:r.createElement(Ge,{})}));(function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,145)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))})()}},[[97,1,2]]]);
//# sourceMappingURL=main.73235b75.chunk.js.map